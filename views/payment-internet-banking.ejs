<%- include('layouts/header'); %>

<div class="container mt-5">
  <h2>Internet Banking Payment Demo</h2>
  <p>Order ID: <%= order._id %></p>
  <p>Total Amount: $<%= order.totalPrice %></p>

  <p>Please click the button below to "pay" your order:</p>

  <form id="internetBankingForm">
    <button type="button" id="payBtn" class="btn btn-success">Pay Now</button>
  </form>

  <div id="paymentMessage" class="mt-3 text-success"></div>
</div>

<script>
  document.getElementById('payBtn').addEventListener('click', async () => {
    const orderId = "<%= order._id %>";

    try {
      const res = await fetch(`/place-order/payment-success/${orderId}`, {
        method: 'POST'
      });
      const data = await res.json();
      if (data.success) {
        document.getElementById('paymentMessage').innerText = 'Payment successful! Your order is now Processing.';
      } else {
        document.getElementById('paymentMessage').innerText = 'Payment failed!';
      }
    } catch (err) {
      console.error(err);
      document.getElementById('paymentMessage').innerText = 'Error occurred during payment!';
    }
  });
</script>

<%- include('layouts/footer'); %>
